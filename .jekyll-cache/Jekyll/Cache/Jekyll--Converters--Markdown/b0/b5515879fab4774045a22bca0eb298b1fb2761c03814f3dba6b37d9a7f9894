I"ÏF<p>First of all you need to install Deep Learning Studio. If you havenâ€™t completed that step, please go to the <a href="/install/">installation section</a>.</p>

<p>We additionally have some implemented algorithms that you can use in Deep Learning Studio. Find them in the <a href="/quick_start/algorithms_zoo/">algorithms zoo</a>.</p>

<p>If youâ€™d like to train your own brain, we provide you with the <a href="/quick_start/datasets">datasets</a>.</p>

<p>This repository contains the deep learning regression and classification models for all robots used in the JdeRobot community.</p>

<h2 id="structure-of-the-branch">Structure of the branch</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â”œâ”€â”€ Formula1-FollowLine
|   |
|   |â”€â”€ pytorch
|   |   |â”€â”€ PilotNet                                # Pilot Net pytorch implementation
|   |   |   â”œâ”€â”€ scripts                             # scripts for running experiments 
|   |   |   â”œâ”€â”€ utils                               
|   |   |   |   â”œâ”€â”€ pilot_net_dataset.py            # Torchvision custom dataset
|   |   |   |   â”œâ”€â”€ pilotnet.py                     # CNN for PilotNet
|   |   |   |   â”œâ”€â”€ transform_helpers.py            # Data Augmentation
|   |   |   |   â””â”€â”€ processing.py                   # Data collecting, processing and utilities
|   |   |   â””â”€â”€ train.py                            # training code
|   |   |
|   |   â””â”€â”€ PilotNetStacked                         # Pilot Net Stacked Image implementation
|   |       â”œâ”€â”€ scripts                             # scripts for running experiments 
|   |       â”œâ”€â”€ utils                               
|   |       |   â”œâ”€â”€ pilot_net_dataset.py            # Sequentially stacked image dataset
|   |       |   â”œâ”€â”€ pilotnet.py                     # Modified Hyperparams 
|   |       |   â”œâ”€â”€ transform_helpers.py            # Data Augmentation
|   |       |   â””â”€â”€ processing.py                   # Data collecting, processing and utilities
|   |       â””â”€â”€ train.py                            # training code
|   |
|   +â”€â”€ tensoflow
|       +â”€â”€ PilotNet                                # Pilot Net tensorflow implementation
|           â”œâ”€â”€ utils                               
|           |   â”œâ”€â”€ dataset.py                      # Custom dataset
|           |   â”œâ”€â”€ pilotnet.py                     # CNN for PilotNet
|           |   â””â”€â”€ processing.py                   # Data collecting, processing and utilities
|           â””â”€â”€ train.py                            # training code
+â”€â”€ Drone-FollowLine
    |
    +â”€â”€ DeepPilot                               # DeepPilot CNN pytorch implementation
        â”œâ”€â”€ scripts                             # scripts for running experiments 
        â”œâ”€â”€ utils                               
        |   â”œâ”€â”€ pilot_net_dataset.py            # Torchvision custom dataset
        |   â”œâ”€â”€ pilotnet.py                     # CNN for DeepPilot
        |   â”œâ”€â”€ transform_helpers.py            # Data Augmentation
        |   â””â”€â”€ processing.py                   # Data collecting, processing and utilities
        â””â”€â”€ train.py                            # training code
</code></pre></div></div>

<h1 id="formula1-followline-algorithms-implementation-and-baseline">Formula1 Followline Algorithms: Implementation and Baseline</h1>

<p>It contains some deep learning regression models for Formula1 Line Following task.</p>

<p>The models implemented are derived from:</p>
<ol>
  <li>PilotNet for Autonomous Driving with Behaviour Metrics dataset</li>
  <li>PilotNetStacked as an extension of PilotNet with stacked images</li>
</ol>

<p>The algorithms are modular and can adapt to various other datasets. They are both implemented in pytorch and tensorflow.</p>

<h1 id="pytorch-">Pytorch <img src="https://pytorch.org/assets/images/pytorch-logo.png" alt="Pytorch logo" width="50" /></h1>

<h2 id="preparing-dataset">Preparing Dataset</h2>

<p>For PilotNet, we use our custom datasets:</p>
<ul>
  <li>Complete dataset: contains images with annotations from different circuits <a href="https://drive.google.com/file/d/1Xdiu69DLj7lKK37F94qrUWsXkVg4ymGv/view?usp=sharing">https://drive.google.com/file/d/1Xdiu69DLj7lKK37F94qrUWsXkVg4ymGv/view?usp=sharing</a></li>
  <li>Curves dataset: contains images with annotations from many_curves circuit: <a href="https://drive.google.com/file/d/1zCJPFJRqCa34Q6jvktjDBY8Z49bIbvLJ/view?usp=sharing">https://drive.google.com/file/d/1zCJPFJRqCa34Q6jvktjDBY8Z49bIbvLJ/view?usp=sharing</a></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    PilotNet                                # Extract PilotNet dataset here
    â”œâ”€â”€ complete_dataset                    # Extract PilotNet complete_dataset here           
    |   â”œâ”€â”€ Images/                         # Train and Test Images
    |   â””â”€â”€ data.json                       # Annotations
    â””â”€â”€ curves_dataset                      # Extract PilotNet curves_dataset here  
        â”œâ”€â”€ Images/                         # Train and Test Images
        â””â”€â”€ data.json                       # Annotations
</code></pre></div></div>

<h2 id="hyperparameters-for-the-code">Hyperparameters for the code</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># For PilotNet

-h, --help                            show this help message and exit
--data_dir            DATA_DIR        Directory to find Data
--preprocess	      PREPROCESSING   Preprocessing information about cropping and extreme cases 
--base_dir            BASE_DIR        Directory to save everything
--comment             COMMENT         Comment to know the experiment
--data_augs           AUGMENTATIONS   Data augmentations
--num_epochs          NUM_EPOCHS      Number of Epochs
--lr                  LR              Learning rate for Policy Net
--test_split          TEST_SPLIT      Train test Split
--shuffle             SHUFFLE         Shuffle dataset
--batch_size          BATCH_SIZE      Batch size
--save_iter           SAVE_ITER       Iterations to save the model
--print_terminal      PRINT_TERMINAL  Print progress in terminal
--seed                SEED            Seed for reproducing

# For PilotNetStacked, add

--horizon             HORIZON         Stacking horizon to use

</code></pre></div></div>

<h2 id="running-the-code">Running the Code</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> ~/pyenvs/dlstudio/bin/activate
<span class="nb">cd </span>DeepLearningStudio/Formula1-FollowLine/pytorch

<span class="c"># For PilotNet</span>

<span class="nb">cd </span>PilotNet
python train.py <span class="nt">--data_dir</span> <span class="s1">'../datasets/complete_dataset'</span> <span class="se">\</span>
	    <span class="nt">--data_dir</span> <span class="s1">'../datasets/curves_only'</span> <span class="se">\</span>
		<span class="nt">--preprocess</span> <span class="s1">'crop'</span> <span class="se">\</span>
		<span class="nt">--preprocess</span> <span class="s1">'extreme'</span> <span class="se">\</span>
	    <span class="nt">--base_dir</span> testcase <span class="se">\</span>
	    <span class="nt">--comment</span> <span class="s1">'Selected Augmentations: gaussian, affine'</span> <span class="se">\</span>
	    <span class="nt">--data_augs</span> <span class="s1">'gaussian'</span> <span class="se">\</span>
	    <span class="nt">--data_augs</span> <span class="s1">'affine'</span> <span class="se">\</span>
	    <span class="nt">--num_epochs</span> 150 <span class="se">\</span>
	    <span class="nt">--lr</span> 1e-3 <span class="se">\</span>
	    <span class="nt">--test_split</span> 0.2 <span class="se">\</span>
	    <span class="nt">--shuffle</span> True <span class="se">\</span>
	    <span class="nt">--batch_size</span> 128 <span class="se">\</span>
	    <span class="nt">--save_iter</span> 50 <span class="se">\</span>
	    <span class="nt">--print_terminal</span> True <span class="se">\</span>
	    <span class="nt">--seed</span> 123  

<span class="c"># For PilotNetStacked</span>

<span class="nb">cd </span>PilotNetStacked
python train.py <span class="nt">--data_dir</span> <span class="s1">'../datasets/complete_dataset'</span> <span class="se">\</span>
		<span class="nt">--data_dir</span> <span class="s1">'../datasets/curves_only'</span> <span class="se">\</span>
		<span class="nt">--preprocess</span> <span class="s1">'crop'</span> <span class="se">\</span>
		<span class="nt">--preprocess</span> <span class="s1">'extreme'</span> <span class="se">\</span>
		<span class="nt">--base_dir</span> testcase <span class="se">\</span>
		<span class="nt">--comment</span> <span class="s1">'Selected Augmentations: gaussian'</span> <span class="se">\</span>
		<span class="nt">--data_augs</span> <span class="s1">'gaussian'</span> <span class="se">\</span>
		<span class="nt">--num_epochs</span> 150 <span class="se">\</span>
		<span class="nt">--horizon</span> 3 <span class="se">\</span>
		<span class="nt">--lr</span> 1e-3 <span class="se">\</span>
		<span class="nt">--test_split</span> 0.2 <span class="se">\</span>
		<span class="nt">--shuffle</span> True <span class="se">\</span>
		<span class="nt">--batch_size</span> 256 <span class="se">\</span>
		<span class="nt">--save_iter</span> 50 <span class="se">\</span>
		<span class="nt">--print_terminal</span> True <span class="se">\</span>
		<span class="nt">--seed</span> 123
</code></pre></div></div>

<p>The results are saved in the <code class="language-plaintext highlighter-rouge">./experiments/</code> directory and the structure is given below. 
Tensorboard can be launched with <code class="language-plaintext highlighter-rouge">./experiments/base_dir/log</code> directory.</p>

<h1 id="tensorflow-">Tensorflow <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/Tensorflow_logo.svg/1200px-Tensorflow_logo.svg.png" alt="TF logo" width="50" /></h1>

<p>The models implemented are derived from:</p>
<ol>
  <li>PilotNet for Autonomous Driving with Behaviour Metrics dataset</li>
  <li>DeepestLSTMTinyPilotNet as an extension of PilotNet with ConvLSTM layers.</li>
</ol>

<h2 id="preparing-dataset-1">Preparing Dataset</h2>

<p>The same workflow as for PyTorch is followed, refer to the previous section</p>

<h2 id="hyperparameters-for-the-code-1">Hyperparameters for the code</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># For PilotNet or DeepestLSTMTinyPilotNet

-h, --help                            show this help message and exit
--data_dir            DATA_DIR        Directory to find Data
--preprocess          PREPROCESSING   Preprocessing information about cropping and extreme cases 
--data_augs           AUGMENTATIONS   Data augmentations
--num_epochs          NUM_EPOCHS      Number of Epochs
--learning_rate       LR              Learning rate for Policy Net
--batch_size          BATCH_SIZE      Batch size
--img_shape	      IMG_SHAPE	      Image shape


</code></pre></div></div>

<h2 id="running-the-code-1">Running the Code</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> ~/pyenvs/dlstudio/bin/activate
<span class="nb">cd </span>DeepLearningStudio/Formula1-FollowLine/tensorflow

<span class="c"># For PilotNet</span>

<span class="nb">cd </span>PilotNet
python train.py <span class="nt">--data_dir</span> ../complete_dataset/ <span class="se">\</span>
	<span class="nt">--preprocess</span> crop <span class="se">\</span>
	<span class="nt">--preprocess</span> extreme <span class="se">\</span>
	<span class="nt">--data_augs</span> True <span class="se">\</span>
	<span class="nt">--num_epochs</span> 1 <span class="se">\</span>
	<span class="nt">--batch_size</span> 50 <span class="se">\</span>
	<span class="nt">--learning_rate</span> 0.0001 <span class="se">\</span>
	<span class="nt">--img_shape</span> <span class="s2">"200,66,3"</span>
	
	
<span class="c"># For DeepestLSTMTinyPilotNet</span>
python train.py <span class="nt">--data_dir</span> ../complete_dataset/ <span class="se">\</span>
	<span class="nt">--preprocess</span> crop <span class="se">\</span>
	<span class="nt">--preprocess</span> extreme <span class="se">\</span>
	<span class="nt">--data_augs</span> True <span class="se">\</span>
	<span class="nt">--num_epochs</span> 1 <span class="se">\</span>
	<span class="nt">--batch_size</span> 50 <span class="se">\</span>
	<span class="nt">--learning_rate</span> 0.0001 <span class="se">\</span>
	<span class="nt">--img_shape</span> <span class="s2">"100,50,3"</span>

</code></pre></div></div>

<p>The results are saved in  <code class="language-plaintext highlighter-rouge">./</code> directory and the structure is given below. 
Tensorboard can be launched with <code class="language-plaintext highlighter-rouge">logs/fit</code> directory.</p>

<h1 id="drone-followline-algorithms-implementation-and-baseline">Drone Followline Algorithms: Implementation and Baseline</h1>

<p>It contains some deep learning regression models for Iris drone Line Following task.</p>

<p>The models implemented are derived from:</p>
<ol>
  <li>DeepPilot for Autonomous Drone Racing with Behaviour Metrics dataset</li>
</ol>

<p>The algorithms are modular and can adapt to various other datasets.</p>

<h2 id="preparing-dataset-2">Preparing Dataset</h2>

<p>For DeepPilot, we use our custom datasets:</p>
<ul>
  <li>Complete dataset: contains images with annotations from different circuits <a href="https://drive.google.com/file/d/1Xdiu69DLj7lKK37F94qrUWsXkVg4ymGv/view?usp=sharing">https://drive.google.com/file/d/1Xdiu69DLj7lKK37F94qrUWsXkVg4ymGv/view?usp=sharing</a></li>
  <li>Curves dataset: contains images with annotations from many_curves circuit: <a href="https://drive.google.com/file/d/1zCJPFJRqCa34Q6jvktjDBY8Z49bIbvLJ/view?usp=sharing">https://drive.google.com/file/d/1zCJPFJRqCa34Q6jvktjDBY8Z49bIbvLJ/view?usp=sharing</a>
(To Be updated)</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    DeepPilot                               # Extract PilotNet dataset here
    â”œâ”€â”€ complete_dataset                    # Extract PilotNet complete_dataset here           
    |   â”œâ”€â”€ Images/                         # Train and Test Images
    |   â””â”€â”€ data.json                       # Annotations
    â””â”€â”€ curves_dataset                      # Extract PilotNet curves_dataset here  
        â”œâ”€â”€ Images/                         # Train and Test Images
        â””â”€â”€ data.json                       # Annotations
</code></pre></div></div>

<h2 id="hyperparameters-for-the-code-2">Hyperparameters for the code</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># For DeepPilot

-h, --help                            show this help message and exit
--data_dir            DATA_DIR        Directory to find Data
--preprocess		  PREPROCESSING	  Preprocessing information about cropping and extreme cases 
--base_dir            BASE_DIR        Directory to save everything
--comment             COMMENT         Comment to know the experiment
--data_augs           AUGMENTATIONS   Data augmentations
--num_epochs          NUM_EPOCHS      Number of Epochs
--lr                  LR              Learning rate for Policy Net
--test_split          TEST_SPLIT      Train test Split
--shuffle             SHUFFLE         Shuffle dataset
--batch_size          BATCH_SIZE      Batch size
--save_iter           SAVE_ITER       Iterations to save the model
--print_terminal      PRINT_TERMINAL  Print progress in terminal
--seed                SEED            Seed for reproducing

</code></pre></div></div>

<h2 id="running-the-code-2">Running the Code</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> ~/pyenvs/dlstudio/bin/activate
<span class="nb">cd </span>DL_studio/Drone-FollowLine/

<span class="c"># For PilotNet</span>

<span class="nb">cd </span>DeepPilot
python train.py <span class="nt">--data_dir</span> <span class="s1">'../datasets/complete_dataset'</span> <span class="se">\</span>
	    <span class="nt">--data_dir</span> <span class="s1">'../datasets/curves_only'</span> <span class="se">\</span>
		<span class="nt">--preprocess</span> <span class="s1">'crop'</span> <span class="se">\</span>
		<span class="nt">--preprocess</span> <span class="s1">'extreme'</span> <span class="se">\</span>
	    <span class="nt">--base_dir</span> testcase <span class="se">\</span>
	    <span class="nt">--comment</span> <span class="s1">'Selected Augmentations: gaussian, affine'</span> <span class="se">\</span>
	    <span class="nt">--data_augs</span> <span class="s1">'gaussian'</span> <span class="se">\</span>
	    <span class="nt">--data_augs</span> <span class="s1">'affine'</span> <span class="se">\</span>
	    <span class="nt">--num_epochs</span> 150 <span class="se">\</span>
	    <span class="nt">--lr</span> 1e-3 <span class="se">\</span>
	    <span class="nt">--test_split</span> 0.2 <span class="se">\</span>
	    <span class="nt">--shuffle</span> True <span class="se">\</span>
	    <span class="nt">--batch_size</span> 128 <span class="se">\</span>
	    <span class="nt">--save_iter</span> 50 <span class="se">\</span>
	    <span class="nt">--print_terminal</span> True <span class="se">\</span>
	    <span class="nt">--seed</span> 123
</code></pre></div></div>

<p>The results are saved in the <code class="language-plaintext highlighter-rouge">./experiments/</code> directory and the structure is given below. 
Tensorboard can be launched with <code class="language-plaintext highlighter-rouge">./experiments/base_dir/log</code> directory.</p>
:ET